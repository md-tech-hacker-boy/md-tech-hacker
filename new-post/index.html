<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MD TECH HACKER - Admin Panel</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #1a1a1a;
      color: #fff;
      margin: 0;
      padding: 0;
    }
    .light-mode {
      background-color: #ffffff;
      color: #1a1a1a;
    }
    .light-mode .sidebar {
      background-color: #f8f9fa;
    }
    .light-mode .header {
      background-color: #f8f9fa;
      border-bottom: 1px solid #e9ecef;
    }
    .light-mode .search-bar {
      background-color: #ffffff;
      border: 1px solid #e9ecef;
      color: #1a1a1a;
    }
    .light-mode .nav-menu {
      background-color: #ffffff;
      border-bottom: 1px solid #e9ecef;
    }
    .light-mode .admin-card {
      background-color: #f8f9fa;
    }
    .sidebar {
      position: fixed;
      left: 0;
      top: 0;
      width: 70px;
      height: 100vh;
      background-color: #2a2a2a;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 20px;
      z-index: 1000;
    }
    .sidebar-icon {
      width: 40px;
      height: 40px;
      margin: 10px 0;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s;
      color: #888;
    }
    .sidebar-icon:hover {
      background-color: #3a3a3a;
      color: #fff;
    }
    .sidebar-icon a {
      color: inherit;
      text-decoration: none;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
    }
    .main-content {
      margin-left: 70px;
      min-height: 100vh;
    }
    .header {
      background-color: #2a2a2a;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid #3a3a3a;
    }
    .search-bar {
      background-color: #1a1a1a;
      border: 1px solid #3a3a3a;
      border-radius: 20px;
      padding: 8px 15px;
      color: #fff;
      width: 300px;
    }
    .nav-menu {
      background-color: #1a1a1a;
      padding: 20px;
      text-align: center;
      border-bottom: 1px solid #3a3a3a;
    }
    .nav-links {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-bottom: 20px;
    }
    .nav-link {
      color: #ccc;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s;
    }
    .nav-link:hover {
      color: #fff;
    }
    .telegram-banner {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 15px 20px;
      margin: 20px;
      border-radius: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .join-btn {
      background-color: #00d4aa;
      color: #fff;
      padding: 8px 20px;
      border-radius: 20px;
      text-decoration: none;
      font-weight: 600;
      transition: background-color 0.3s;
    }
    .join-btn:hover {
      background-color: #00b894;
    }
    .content-area {
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
    }
    .admin-card {
      background-color: #2a2a2a;
      border-radius: 10px;
      padding: 30px;
      margin-bottom: 20px;
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #fff;
    }
    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 12px;
      border: 1px solid #3a3a3a;
      border-radius: 6px;
      background-color: #1a1a1a;
      color: #fff;
      font-size: 14px;
      font-family: inherit;
    }
    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: #00d4aa;
    }
    .form-group textarea {
      min-height: 120px;
      resize: vertical;
    }
    .checkbox-group {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 8px;
    }
    .checkbox-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .checkbox-item input[type="checkbox"] {
      width: auto;
    }
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 16px;
      margin-right: 10px;
    }
    .btn-primary {
      background-color: #00d4aa;
      color: #fff;
    }
    .btn-primary:hover {
      background-color: #00b894;
    }
    .btn-secondary {
      background-color: #6c757d;
      color: #fff;
    }
    .btn-secondary:hover {
      background-color: #5a6268;
    }
    .btn-danger {
      background-color: #dc3545;
      color: #fff;
    }
    .btn-danger:hover {
      background-color: #c82333;
    }
    .header-icons {
      display: flex;
      gap: 15px;
      align-items: center;
    }
    .header-icon {
      color: #888;
      font-size: 18px;
      cursor: pointer;
      transition: color 0.3s;
    }
    .header-icon:hover {
      color: #fff;
    }
    .admin-access-denied {
      text-align: center;
      padding: 50px 20px;
    }
    .admin-access-denied h2 {
      color: #dc3545;
      margin-bottom: 20px;
    }
    .posts-list {
      margin-top: 30px;
    }
    .post-item {
      background-color: #3a3a3a;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .post-info h4 {
      margin: 0 0 5px 0;
      color: #00d4aa;
    }
    .post-info p {
      margin: 0;
      color: #888;
      font-size: 14px;
    }
    .post-actions {
      display: flex;
      gap: 10px;
    }
    .post-actions button {
      padding: 6px 12px;
      font-size: 12px;
    }
    .bin-details-section {
      display: none;
      background-color: #1a1a1a;
      padding: 20px;
      border-radius: 8px;
      margin-top: 15px;
    }
    .bin-details-section.show {
      display: block;
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-icon">
      <a href="/" title="Home"><i class="fas fa-home"></i></a>
    </div>
    <div class="sidebar-icon">
      <a href="/bins/" title="Bins"><i class="fas fa-credit-card"></i></a>
    </div>
    <div class="sidebar-icon">
      <a href="/methods/" title="Methods"><i class="fas fa-star"></i></a>
    </div>
    <div class="sidebar-icon">
      <a href="/accounts/" title="Accounts"><i class="fas fa-user"></i></a>
    </div>
    <div class="sidebar-icon">
      <a href="/support/" title="Support"><i class="fas fa-shield-alt"></i></a>
    </div>
    <div class="sidebar-icon">
      <a href="/new-post/" title="Admin Panel"><i class="fas fa-plus"></i></a>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Header -->
    <div class="header">
      <h1 class="text-xl font-bold">MD TECH HACKER</h1>
      <input type="text" class="search-bar" placeholder="Search..." />
      <div class="header-icons">
        <i class="header-icon fas fa-bookmark" title="Bookmarks"></i>
        <i class="header-icon fas fa-file-alt" title="Files"></i>
        <i class="header-icon fas fa-user-circle" title="Profile" onclick="toggleLogin()"></i>
        <i class="header-icon fas fa-moon" title="Toggle Theme" onclick="toggleTheme()"></i>
      </div>
    </div>

    <!-- Navigation Menu -->
    <div class="nav-menu">
      <div class="nav-links">
        <a href="/bins/" class="nav-link">BINS</a>
        <a href="/methods/" class="nav-link">METHODS</a>
        <a href="/accounts/" class="nav-link">ACCOUNTS</a>
        <a href="/support/" class="nav-link">SUPPORT</a>
        <a href="/new-post/" class="nav-link">ADMIN</a>
      </div>

      <!-- Telegram Banner -->
      <div class="telegram-banner">
        <span>Join Our Channel Of telegram Now</span>
        <a href="https://t.me/MD_TECH_BOTS" class="join-btn">JOIN NOW!</a>
      </div>
    </div>

    <!-- Content Area -->
    <div class="content-area">
      <!-- Access Denied Message -->
      <div class="admin-access-denied" id="access-denied">
        <h2><i class="fas fa-lock"></i> Access Denied</h2>
        <p>You need admin privileges to access this panel.</p>
        <p>Please login with an admin account or contact the administrator.</p>
        <button class="btn btn-primary" onclick="window.location.href='/accounts/'">Go to Login</button>
      </div>

      <!-- Admin Panel -->
      <div class="admin-panel" id="admin-panel" style="display: none;">
        <h2><i class="fas fa-cog"></i> Admin Panel</h2>
        <p>Create and manage BINs, methods, and other content.</p>

        <!-- New Post Form -->
        <div class="admin-card">
          <h3>Create New Post</h3>
          <form id="new-post-form">
            <div class="form-group">
              <label for="post-title">Title *</label>
              <input type="text" id="post-title" required placeholder="Enter post title" />
            </div>

            <div class="form-group">
              <label for="post-content">Content *</label>
              <textarea id="post-content" required placeholder="Enter post content"></textarea>
            </div>

            <div class="form-group">
              <label for="post-type">Post Type *</label>
              <select id="post-type" required onchange="toggleBinDetails()">
                <option value="">Select post type</option>
                <option value="bin">BIN</option>
                <option value="method">Method</option>
                <option value="general">General</option>
              </select>
            </div>

            <div class="form-group">
              <label>Categories</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input type="checkbox" id="cat-bin" value="BIN" />
                  <label for="cat-bin">BIN</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="cat-method" value="Method" />
                  <label for="cat-method">Method</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="cat-tools" value="Tools" />
                  <label for="cat-tools">Tools</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="cat-tutorial" value="Tutorial" />
                  <label for="cat-tutorial">Tutorial</label>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="post-status">Status</label>
              <select id="post-status">
                <option value="published">Published</option>
                <option value="draft">Draft</option>
              </select>
            </div>

            <div class="form-group">
              <label for="publish-date">Publish Date</label>
              <input type="datetime-local" id="publish-date" />
            </div>

            <!-- BIN Details Section -->
            <div class="bin-details-section" id="bin-details-section">
              <h4>BIN Details</h4>
              <div class="form-group">
                <label for="bin-number">BIN Number</label>
                <input type="text" id="bin-number" placeholder="e.g., 4532 15xx xxxx xxxx" />
              </div>
              <div class="form-group">
                <label for="bin-type">Card Type</label>
                <select id="bin-type">
                  <option value="">Select card type</option>
                  <option value="visa">Visa</option>
                  <option value="mastercard">Mastercard</option>
                  <option value="amex">American Express</option>
                  <option value="discover">Discover</option>
                </select>
              </div>
              <div class="form-group">
                <label for="bin-bank">Bank</label>
                <input type="text" id="bin-bank" placeholder="e.g., Chase Bank" />
              </div>
              <div class="form-group">
                <label for="bin-country">Country</label>
                <input type="text" id="bin-country" placeholder="e.g., United States" />
              </div>
              <div class="form-group">
                <label for="success-rate">Success Rate (%)</label>
                <input type="number" id="success-rate" min="0" max="100" placeholder="85" />
              </div>
            </div>

            <div class="form-group">
              <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i> Create Post
              </button>
              <button type="button" class="btn btn-secondary" onclick="resetForm()">
                <i class="fas fa-undo"></i> Reset
              </button>
            </div>
          </form>
        </div>

        <!-- Existing Posts -->
        <div class="admin-card">
          <h3>Manage Posts</h3>
          <div class="posts-list" id="posts-list">
            <!-- Posts will be loaded here -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="../js/main.js"></script>
  <script>
    let currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
    let posts = JSON.parse(localStorage.getItem('posts') || '[]');

    function checkAdminAccess() {
      if (!currentUser) {
        document.getElementById('access-denied').style.display = 'block';
        document.getElementById('admin-panel').style.display = 'none';
        return false;
      }

      // Check if user is admin with specific credentials
      const isAdmin = currentUser.email === 'keygenmd5@gmail.com' || 
                     currentUser.email === 'm.dharaaneesh123@gmail.com' ||
                     currentUser.username === 'MD_TECH_HACKER' ||
                     currentUser.username === 'admin';

      if (isAdmin) {
        document.getElementById('access-denied').style.display = 'none';
        document.getElementById('admin-panel').style.display = 'block';
        loadPosts();
        return true;
      } else {
        document.getElementById('access-denied').style.display = 'block';
        document.getElementById('admin-panel').style.display = 'none';
        return false;
      }
    }

    function toggleBinDetails() {
      const postType = document.getElementById('post-type').value;
      const binDetailsSection = document.getElementById('bin-details-section');
      
      if (postType === 'bin') {
        binDetailsSection.classList.add('show');
      } else {
        binDetailsSection.classList.remove('show');
      }
    }

    function resetForm() {
      document.getElementById('new-post-form').reset();
      document.getElementById('bin-details-section').classList.remove('show');
      document.getElementById('publish-date').value = new Date().toISOString().slice(0, 16);
    }

    // Form submission
    document.getElementById('new-post-form').addEventListener('submit', function(e) {
      e.preventDefault();

      const title = document.getElementById('post-title').value;
      const content = document.getElementById('post-content').value;
      const postType = document.getElementById('post-type').value;
      const status = document.getElementById('post-status').value;
      const publishDate = document.getElementById('publish-date').value || new Date().toISOString();

      // Get selected categories
      const categories = [];
      document.querySelectorAll('input[type="checkbox"]:checked').forEach(cb => {
        categories.push(cb.value);
      });

      // Create post object
      const newPost = {
        id: Date.now(),
        title: title,
        content: content,
        type: postType,
        status: status,
        publishDate: publishDate,
        categories: categories,
        author: currentUser.username,
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString()
      };

      // Add BIN details if it's a BIN post
      if (postType === 'bin') {
        newPost.binDetails = {
          binNumber: document.getElementById('bin-number').value,
          cardType: document.getElementById('bin-type').value,
          bank: document.getElementById('bin-bank').value,
          country: document.getElementById('bin-country').value,
          successRate: document.getElementById('success-rate').value
        };
      }

      // Save post
      posts.push(newPost);
      localStorage.setItem('posts', JSON.stringify(posts));

      // Show success message
      if (window.MDTech && window.MDTech.showNotification) {
        window.MDTech.showNotification('Post created successfully!', 'success');
      }

      // Reset form and reload posts
      resetForm();
      loadPosts();
    });

    function loadPosts() {
      const postsList = document.getElementById('posts-list');
      
      if (posts.length === 0) {
        postsList.innerHTML = '<p style="text-align: center; color: #888;">No posts created yet</p>';
        return;
      }

      postsList.innerHTML = posts.map(post => `
        <div class="post-item">
          <div class="post-info">
            <h4>${post.title}</h4>
            <p>${post.type.toUpperCase()} • ${post.status} • Created ${new Date(post.createdAt).toLocaleDateString()}</p>
          </div>
          <div class="post-actions">
            <button class="btn btn-secondary" onclick="editPost(${post.id})">
              <i class="fas fa-edit"></i> Edit
            </button>
            <button class="btn btn-danger" onclick="deletePost(${post.id})">
              <i class="fas fa-trash"></i> Delete
            </button>
          </div>
        </div>
      `).join('');
    }

    function editPost(postId) {
      const post = posts.find(p => p.id === postId);
      if (!post) return;

      // Fill form with post data
      document.getElementById('post-title').value = post.title;
      document.getElementById('post-content').value = post.content;
      document.getElementById('post-type').value = post.type;
      document.getElementById('post-status').value = post.status;
      document.getElementById('publish-date').value = post.publishDate.slice(0, 16);

      // Set categories
      document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        cb.checked = post.categories.includes(cb.value);
      });

      // Fill BIN details if applicable
      if (post.type === 'bin' && post.binDetails) {
        document.getElementById('bin-number').value = post.binDetails.binNumber || '';
        document.getElementById('bin-type').value = post.binDetails.cardType || '';
        document.getElementById('bin-bank').value = post.binDetails.bank || '';
        document.getElementById('bin-country').value = post.binDetails.country || '';
        document.getElementById('success-rate').value = post.binDetails.successRate || '';
        toggleBinDetails();
      }

      // Remove the post from array (will be re-added when form is submitted)
      posts = posts.filter(p => p.id !== postId);
      localStorage.setItem('posts', JSON.stringify(posts));

      if (window.MDTech && window.MDTech.showNotification) {
        window.MDTech.showNotification('Post loaded for editing', 'info');
      }
    }

    function deletePost(postId) {
      if (confirm('Are you sure you want to delete this post?')) {
        posts = posts.filter(p => p.id !== postId);
        localStorage.setItem('posts', JSON.stringify(posts));
        loadPosts();
        
        if (window.MDTech && window.MDTech.showNotification) {
          window.MDTech.showNotification('Post deleted successfully', 'success');
        }
      }
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      // Set default publish date
      document.getElementById('publish-date').value = new Date().toISOString().slice(0, 16);
      
      // Check admin access
      checkAdminAccess();
      
      // Listen for user login changes
      setInterval(() => {
        const newUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
        if (newUser !== currentUser) {
          currentUser = newUser;
          checkAdminAccess();
        }
      }, 1000);
    });
  </script>
</body>
</html>
